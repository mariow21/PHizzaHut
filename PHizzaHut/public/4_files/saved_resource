this.Chicory=this.Chicory||{},this.Chicory["wrapper.full"]=function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="https://prod-cdn.chicoryapp.com/chicory-publisher-sdk/",n(n.s=6)}([function(e,t,n){(function(t){e.exports=t.dom=n(7)}).call(t,n(2))},function(e,t,n){"use strict";for(var i=[],r=0;r<256;++r)i[r]=(r+256).toString(16).substr(1);t.a=function(e,t){var n=t||0,r=i;return[r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]]].join("")}},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(14);n.d(t,"v1",function(){return i.a});var r=n(15);n.d(t,"v3",function(){return r.a});var o=n(17);n.d(t,"v4",function(){return o.a});var s=n(18);n.d(t,"v5",function(){return s.a})},function(e,t,n){"use strict";t.a=function(){if(!i)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return i(r)};var i="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),r=new Uint8Array(16)},function(e,t,n){"use strict";var i=n(1);t.a=function(e,t,n){var r=function(e,r,o,s){var a=o&&s||0;if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));for(var t=new Array(e.length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(e)),"string"==typeof r&&(r=function(e){var t=[];return e.replace(/[a-fA-F0-9]{2}/g,function(e){t.push(parseInt(e,16))}),t}(r)),!Array.isArray(e))throw TypeError("value must be an array of bytes");if(!Array.isArray(r)||16!==r.length)throw TypeError("namespace must be uuid string or an Array of 16 byte values");var c=n(r.concat(e));if(c[6]=15&c[6]|t,c[8]=63&c[8]|128,o)for(var u=0;u<16;++u)o[a+u]=c[u];return o||Object(i.a)(c)};try{r.name=e}catch(e){}return r.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",r.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",r}},function(e,t,n){"use strict";var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=a(n(0)),o=(a(n(13)),a(n(20))),s=a(n(26));function a(e){return e&&e.__esModule?e:{default:e}}var c=window.location.protocol+"//chicoryapp.com",u=document.currentScript,l=localStorage.getItem("engine");console.log("LS_ENGINE",l);var f={native:o.default,segments:s.default},h=function(){function e(){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.components={},this.settings={},this.current_url="",Object.assign&&String.prototype.startsWith&&String.prototype.endsWith&&window.fetch)this.init();else{var t=document.createElement("script");t.type="text/javascript",t.async=!1,t.src="https://cdn.polyfill.io/v2/polyfill.js?rum=0&unknown=polyfill&features=Object.assign,String.prototype.startsWith,String.prototype.endsWith,fetch",t.onload=function(){this.init()}.bind(this),t.onerror=function(){throw new Error("Failed to polyfill needed features")},document.body.appendChild(t)}}return i(e,[{key:"init",value:function(){try{this.loading=!1;var e=window.ChicoryObject||"chicory",t=window[e];if(t)console.log("Chicory: running in SDK mode"),r.default.each(t.q,function(e,t){var n=[].slice.call(t);this[n.shift()].apply(this,n)}.bind(this));else{console.log("Chicory: running in standalone mode");var n=window.location.href,i=(0,r.default)("meta[property='og:url']");r.default.is_valid_url(i.attr("content"))&&i.length&&n&&new URL(n).hostname===new URL(i.attr("content")).hostname&&(n=i.attr("content"));var o=(0,r.default)("link[rel='canonical']");if(r.default.is_valid_url(o.attr("href"))&&1==o.length&&n&&new URL(n).hostname===new URL(o.attr("href")).hostname&&(n=o.attr("href")),!n)throw Error("Chicory cannot detect the page url.");r.default.ready(this.setRecipe.bind(this,n))}window[e]=function(){var e=[].slice.call(arguments);this[e.shift()].apply(this,e)}.bind(this),this.injectCSS()}catch(e){throw r.default.log(e),e}}},{key:"injectCSS",value:function(){var e=document.createElement("style");e.appendChild(document.createTextNode("@media print { .chicory-noprint { display: none !important; } }")),document.getElementsByTagName("head")[0].appendChild(e)}},{key:"resetComponents",value:function(){r.default.each(this.components,function(e,t){t.sdk.deactivate()})}},{key:"loadComponent",value:function(e){return new Promise(function(t,n){e.endpoint?r.default.script(e.endpoint).then(function(){e.sdk=window.Chicory[e.name].default,this.components[e.name]=e,t(e)}.bind(this)).catch(n):e.name in f?(e.sdk=f[e.name],this.components[e.name]=e,t(e)):n()}.bind(this))}},{key:"setRecipe",value:function(e){if(this.current_url!==e){var t=this;try{if(this.loading)return;if(this.loading=!0,this.resetComponents(),!e)return void(this.loading=!1);var n=r.default.extend({url:e},r.default.params(u.src));r.default.get(c+"/api/chicory",n).then(function(n){n.settings.host&&960===n.settings.host.id&&r.default.log(new Error("Yummly recipe lookup: "+n.ready));var i=localStorage.getItem("zip_code");i&&"null"!==i&&"undefined"!==i&&(n.settings.zip_code=i);var o=localStorage.getItem("country_code");o&&"null"!==o&&"undefined"!==o&&(n.settings.country_code=o),n.ready?(window.addEventListener("message",function(e){try{"chicory_iba_enabled"===JSON.parse(e.data).caller&&window.load_segments&&this.loadComponent({name:"segments"}).then(function(e){e.sdk.activate(n.settings)}).catch(r.default.done)}catch(e){}}.bind(this)),r.default.each(n.components,function(e,i){"segments"!==i.name?this.loadComponent(i).then(function(e){"ecommerce"===e.name?e.sdk.activate(t.getEcommerceSettings(n)):e.sdk.activate(n.settings)}).catch(r.default.done):window.load_segments=!0}.bind(this)),r.default.send("load_recipe",n.settings),this.current_url=e,this.loading=!1):this.loading=!1}.bind(this)).catch(r.default.done)}catch(e){r.default.log(e),console.log(e)}}}},{key:"setButtons",value:function(e){try{var t=this;r.default.get(c+"/api/sdk",{components:"ecommerce",pub_id:e.pub_id,button_copy:e.button_copy}).then(function(n){Object.keys(n.components).forEach(function(e){"analytics"===n.components[e].name&&(t.analytics=n.components[e]),"ecommerce"===n.components[e].name&&(t.ecommerce=n.components[e])}),t.setChicoryButtons(e,n.settings)}.bind(this)).catch(r.default.done)}catch(e){r.default.log(e),console.log(e)}}},{key:"setShopperSelect",value:function(e){try{var t=this;t.analytics={endpoint:c+"/sdk/analytics.js",name:"analytics"},this.loadComponent(this.analytics).then(function(e){r.default.extend({recipe:{},host:{}},t.settings),e.sdk.activate({recipe:{id:0,servings:0},host:{}})}).catch(r.default.done),t.shopperselect={endpoint:c+"/sdk/shopperselect.js",name:"shopperselect"},this.loadComponent(this.shopperselect).then(function(n){r.default.extend({recipe:{},host:{}},t.settings),n.sdk.activate(e)}).catch(r.default.done)}catch(e){r.default.log(e),console.log(e)}}},{key:"setChicoryButtons",value:function(e,t){try{if(this.loading)return;this.loading=!0,this.resetComponents();var n=e.pub_id,i=e.button_copy||"Buy Now",o=e.item_selector||".gridInfo",s=(e.button_container_selector,e.checkout_param_selector_tag_name||"h4"),a=document.querySelectorAll(o);this.loadComponent(this.analytics).then(function(e){r.default.extend({recipe:{},host:{}},c.settings),e.sdk.activate({recipe:{id:n,servings:0},is_mobile:t?t.is_mobile:null,host:{}})}).catch(r.default.done);var c=this;Object.keys(a).forEach(function(o){var u=a[o],l=u.getElementsByTagName(s)[0].innerText,f=[{search_query:l=u.getElementsByTagName(s)[0].getAttribute("data-query")?u.getElementsByTagName(s)[0].getAttribute("data-query"):l,measure:"count",text:null,ingredient:null}],h=u.getAttribute("id");h||(h="chicory_"+Math.random(),u.setAttribute("id",h));var d=[c.ecommerce],p={},g={id:n,servings:1,url:l,name:l,ingredient_lines:f},v=[],m={url:g.url,recipe:g,selector:""+h};e.button_container_selector&&(m.selector=e.button_container_selector),v.push(m),p.settings={type:"buy-buttons",recipe:g,recipes:v,host:{button_copy:i,id:n,button_template:"CLEAR",grocer_blacklist:["instacart","wholefoodsmarket","schnucks","smartandfinal","samsclub","vons","shaws","jewelosco","pavilions","starmarket","acmemarkets","safeway","albertsons","shoprite","instacart","meijer","walmart","amazon","peapod","targetfresh","targetshipping"]},location:"custom",cart:{options:{},analytics:{event:"buy_button_click",publisher_id:n,is_mobile:t?t.is_mobile:null},items:[{productSpecs:[{searchQuery:l}]}]}},p.components=d,r.default.each(p.components,function(e,t){c.loadComponent(t).then(function(e){r.default.extend(p.settings,c.settings),e.sdk.activate(p.settings)}).catch(r.default.done)}),r.default.send("load_recipe",p.settings)})}catch(e){r.default.log(e),console.log(e)}}},{key:"clearRecipes",value:function(){this.resetComponents()}},{key:"setRecipes",value:function(e){try{if(this.loading)return;if(this.loading=!0,this.resetComponents(),!e)throw new Error("Chicory: Missing recipes when looking up recipes.");if(e.length>1&&!this.settings.publisher_id)throw new Error("Chicory: Missing publisher_id when looking up multiple recipes.");var t={recipes:e};this.settings.publisher_id&&(t.publisher_id=this.settings.publisher_id),r.default.post(c+"/api/chicory",JSON.stringify(t)).then(function(e){var t=this;this.loading=!1,e.ready&&(r.default.each(e.components,function(n,i){this.loadComponent(i).then(function(n){r.default.extend(e.settings,t.settings),n.sdk.activate(e.settings)}).catch(r.default.done)}.bind(this)),r.default.send("load_recipe",e.settings))}.bind(this)).catch(r.default.done)}catch(e){r.default.log(e),console.log(e)}}},{key:"setOption",value:function(e,t){this.settings[e]=t}},{key:"getEcommerceSettings",value:function(e){var t=[];r.default.each(e.settings.recipe.ingredient_lines,function(e,n){t.push({text:n.text,ingredient:{name:n.ingredient+"",measure:n.measure+"",quantity:n.quantity},productSpecs:[{searchQuery:n.search_query,quantity:n.quantity,priority:0}]})});var n=[];return"company"in e.settings.host&&e.settings.host.company&&"brands"in e.settings.host.company&&(n=e.settings.host.company.brands),{recipe:{id:e.settings.recipe.id,name:e.settings.recipe.name,source_uri:e.settings.recipe.source_uri,source_image_uri:e.settings.recipe.source_image_uri,servings:e.settings.recipe.servings,is_mobile:e.settings.recipe.is_mobile,ingredient_lines:e.settings.recipe.ingredient_lines},host:e.settings.host,cart:{options:{retailer:{},blacklistedBrands:e.settings.host.brand_blacklist,blacklistedRetailers:e.settings.host.grocer_blacklist,preferredBrands:n,affiliateKeys:e.settings.host.affiliate_keys},items:t,analytics:{recipe_id:e.settings.recipe.id,zip_code:e.settings.zip_code,event:"ra_grocer_redirect",oauth_event:"ra_retailer_oauth",is_mobile:e.settings.is_mobile+""}},is_mobile:e.settings.is_mobile,country_code:e.settings.country_code,new_funnel:e.settings.new_funnel,zip_code:e.settings.zip_code}}}]),e}();window.__CHICORY__||(window.__CHICORY__=new h)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(8),r=n(9);window.Promise.prototype.done=function(){this.catch(function(e){throw c.log(e),e})};var o=n(10),s=n(11);o.init({token:"e6d3166d-96cb-4e5d-8a52-da09bbede5e8"});class a{constructor(e=[]){this.elements=e}static select(e,t){return[].slice.call(e.querySelectorAll(t))}get length(){return this.elements.length}hide(){this.css("display","none")}show(){this.css("display","auto")}viewable(){let e=this.elements.filter(function(e){return e.offsetWidth>0||e.offsetHeight>0||e.getClientRects().length>0});return new a(e)}first(){return new a(this.elements.slice(0,1))}last(){return new a(this.elements.slice(-1))}parent(){let e=[];return this.elements.forEach(function(t){e=e.concat(t.parentElement)}),new a(e)}children(){let e=[];return this.elements.forEach(function(t){e=e.concat([].slice.call(t.children))}),new a(e)}find(e){let t=[];return this.elements.forEach(function(n){t=t.concat(a.select(n,e))}),new a(t)}width(){let e=this.elements.slice(0,1).pop();return e?e.getBoundingClientRect().width:0}height(){let e=this.elements.slice(0,1).pop();return e?e.getBoundingClientRect().height:0}css(e,t){if(void 0===t){let t=this.elements.slice(0,1).pop();return t?t.style[e]:null}return this.elements.forEach(function(n){n.style[e]=t}),this}attr(e,t){if(void 0===t){let t=this.elements.slice(0,1).pop();return t?t.getAttribute(e):null}return this.elements.forEach(function(n){t&&n.setAttribute(e,t)}),this}each(e){return this.elements.forEach(e),this}on(e,t){return this.elements.forEach(function(n){if("view"===e){let e=function(e){let i,r=n.getBoundingClientRect(),o=n.getAttribute("data-position")||"unknown";return i=r.bottom<=r.height/2?"above":r.top>=window.innerHeight-r.height/2?"below":"within",n.setAttribute("data-position",i),"unknown"===o&&["within","above"].indexOf(i)>-1?t(e):"below"===o&&"within"===i?t(e):void 0};window.addEventListener("scroll",e),e({})}n.addEventListener(e,t,!1)}),this}prepend(e){return this}append(e){return this.elements.forEach(function(t){e.each(function(e){t.appendChild(e)})}),this}before(e){return this}after(e){return this.elements.forEach(function(t){e.each(function(e){t.parentNode.insertBefore(e,t.nextSibling)})}),this}remove(){return this.elements.forEach(function(e){e.remove()}),this}}let c=function(e){if(e instanceof String||"string"==typeof e){if((e=e.trim()).startsWith("<")&&e.endsWith(">")){let t=document.createElement("template");return t.innerHTML=e,new a([t.content.firstChild])}return new a(a.select(document,e))}if(e instanceof HTMLDocument)return new a([e.documentElement]);if(e instanceof Node)return new a([e]);if(void 0===e)return new a;throw TypeError("Chicory: selector should be of type String or Node")};c.ready=function(e,t){let n=e.bind(window,t);if("loading"!==document.readyState)return void n();let i=document.onreadystatechange;document.onreadystatechange=function(){"loading"!==document.readyState&&(n(),i&&i())}},c.init=function(e){},c.log=function(e){console.log(e);try{let t={error:{name:e.name,message:e.message,stack:s.parse(e).map(function(e){return e.toString()})},page:{url:window.location.href,hostname:window.location.hostname,referrer:window.document.referrer,language:window.navigator.language||navigator.userLanguage,encoding:window.document.characterSet||window.document.defaultCharset},ua:navigator.userAgent};o.error(t)}catch(e){console.log(e)}},c.params=function(e){let t,n={},i=/[?&;](.+?)=([^&;]+)/g;if(!e)return{};for(;t=i.exec(e);)n[t[1]]=t[2];return n},c.query=function(e){if(!e)return"";let t=Object.keys(e).map(function(t){return encodeURIComponent(t)+"="+encodeURIComponent(e[t])}).join("&");return t?"?"+t:""},c.capitalize=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},c.get=function(e,t={},n={},i="json"){let r=new Request(e+c.query(t),c.extend({mode:"cors",credentials:"omit",redirect:"error",cache:"no-store"},n));return fetch(r).then(function(e){if(!e.ok)throw new Error("Network response was not ok: "+e.statusText);return e[i]()})},c.post=function(e,t={},n={},i="json"){let r={headers:{"Content-Type":"application/json"},method:"POST",body:t,mode:"cors",credentials:"omit",redirect:"error",cache:"no-store"},o=new Request(e,c.extend(r,n));return fetch(o).then(function(e){if(!e.ok)throw new Error("Network response was not ok: "+e.statusText);return e[i]()})},c.func=function(e,t){return new Function("return function (call) { return function "+e+" () { return call(this, arguments) }; };")()(Function.apply.bind(t))},c.named=function(e,t){return new Function("return function (call) { return function "+e+" () { return call(this, arguments) }; };")()(Function.apply.bind(t))},c.each=function(e,t){e instanceof Array?e.forEach(function(n,i){t.call(e,i,n)}):e instanceof Object&&Object.keys(e).forEach(function(n){t.call(e,n,e[n])})},c.extend=function(){return Object.assign.apply(this,arguments)},c.sanitize=function(e){return(e=e.toString())&&""!==e?e.toLowerCase().replace(/[\r\n]+/g,"").replace(/\s+/g," ").replace(/^\s+|\s+$/,"").replace(/\(/g,"").replace(/\)/g,"").replace(/\*/g,"").replace(/\u21b5/g,"").trim():e},c.search=function(e,t,n=new a,i=0){return e.children().each(function(e){let r=c.sanitize(e.textContent);t=c.sanitize(t),r.length>0&&t.toLowerCase().trim().startsWith(r)&&(n=new a([e])),n.length<1&&i<3&&"wprm-recipe-ingredient"!=e.className&&(n=c.search(new a([e]),t,n,i++))}),n},c.fulltext=function(e,t,n){var i=new a,o={},s=r.a;if(s.load({}),e&&e.length>0){let t=0;e.elements.forEach(function(e){e&&function(e,t=0){let n=e;const i=[n];let r=0;for(;n=i.shift();){let e=t+"_"+r++;s.add(e,c.sanitize(n.textContent)),o[e]={element:n,type:n.tagName.toLowerCase()},Array.from(n.children).forEach(e=>{i.push(e)})}}(e,t),t++})}var u=c.sanitize(t),l=s.find(u);l.length<1&&(l=s.find(c.sanitize(n)));var f=l[l.length-1];return f?("span"===o[f].type&&l.forEach(function(e){"li"===o[e].type&&(f=e)}),o[f]&&(i=new a([o[f].element])),i):[]},c.goto=function(e){window.open(e)},c.getPageStructure=function(){let e={post:c(),recipe:c(),ingredients:c(),preps:c()};e.post=c(".entry-content, .post-content, .post_content, .post_article, .blog-yumprint-recipe, .recipe-single-instructions").viewable().first();let t=c(".wpurp-container").viewable().first();if(t.length)return e.recipe=t,e.ingredients=t.find(".wpurp-recipe-ingredients").viewable().first(),e.preps=t.find(".wpurp-recipe-instructions").viewable().first(),e;let n=c('[itemtype*="schema.org/Recipe"], #mpprecipe-ingredients-list').viewable().first();if(n.length&&!document.location.host.includes("halfbakedharvest"))return e.recipe=n,e.ingredients=n.find('[itemprop="ingredients"], [itemprop="recipeIngredient"]').viewable().parent().last(),e.preps=n.find("div#this_recipe > div.preps").viewable(),e;let i=c(".hrecipe").viewable().first();if(i.length)return e.recipe=i,e.ingredients=i.find(".ingredient").viewable().parent().last(),e;let r=c(".h-recipe").viewable().first();if(r.length)return e.recipe=r,e.ingredients=r.find(".p-ingredient").viewable().parent().last(),e.preps=r.find(".e-instructions").viewable(),e;let o=c(".recipe-single-container").viewable().last();if(o.length)return e.recipe=o,e.ingredients=o.find(".recipe-ingredients").viewable().first(),e.preps=o.find(".recipe-directions").viewable().first(),e;let s=c(".recipe-ingredients").viewable().first();if(s.length)return e.recipe=s,e.ingredients=s.find(".List").viewable(),e;let a=c(".tasty-recipes").viewable().first();if(a.length){e.recipe=a;let t=a.find(".tasty-recipe-ingredients").viewable().first();return t.elements.length?e.ingredients=t:e.ingredients=a.find(".tasty-recipes-ingredients").viewable().first(),e.preps=a.find(".tasty-recipe-instructions").viewable().first(),e}let u=c(".wprm-recipe-container").viewable().first();if(u.length)return e.recipe=u,e.ingredients=u.find(".wprm-recipe-ingredients-container").viewable().first(),e.preps=u.find(".wprm-recipe-instructions-container").viewable().first(),e;let l=c(".mv-recipe-card").viewable().first();if(l.length)return e.recipe=l,e.ingredients=l.find(".mv-create-ingredients").viewable().first(),e.preps=l.find(".mv-create-instructions").viewable().first(),e;let f=c(".rpr-ingredients-container").viewable().first();if(f.length)return e.recipe=f,e.ingredients=f.find(".rpr-ingredient-list").viewable().first(),e.preps=null,e;let h=c(".cooked-recipe-ingredients").viewable().first();if(h.length)return e.recipe=h,e.ingredients=h,e.preps=null,e;let d=c(".recipe-content").viewable().first();if(d.length)return e.recipe=d,e.ingredients=d.find(".ingredients-list").viewable().first(),e.ingredients.length||(e.ingredients=d.find(".ingredient-list").viewable().first()),e.preps=d.find(".directions-list").viewable().first(),e.preps.length||(e.preps=d.find(".numbered-direction-list").viewable().first()),e;let p=c(".Recipe").viewable().first();if(p.length)return e.recipe=p,e.ingredients=c(".Recipe__ingredientsGroups").viewable().first(),e.preps=c(".Recipe__instructionsGroup").viewable().first(),e;let g=c(".recipe-tabs").viewable().first();if(g.length)return e.recipe=g,e.ingredients=g.find(".ingredients-list").viewable().first(),e.preps=g.find(".recipe-instructions").viewable().first(),e;let v=c(".recipe-container").viewable().first();if(v.length)return e.recipe=v,e.ingredients=v.find(".ingredient-lists").viewable().first(),e.preps=v.find(".directions").viewable().first(),e;let m=c(".recipe__text").viewable().first();return m.length?(e.recipe=m,e.ingredients=m.find(".recipe__list--ingredients").viewable().first(),e.preps=m.find("recipe__list--steps").viewable().first(),e):e},c.script=function(e){return new Promise(function(t,n){let i=document.createElement("script");return i.type="text/javascript",i.async=!0,i.src=e,i.onload=t,i.onerror=n,document.body.appendChild(i),i})},c.iframe=function(e){return new Promise(function(t,n){let i=document.createElement("iframe");i.src=e,i.width="0",i.height="0",i.frameborder="0",i.style="display:none",i.onload=t,i.onerror=n,document.body.appendChild(i)})},c.image=function(e){return new Promise(function(t,n){let i=document.createElement("img");i.src=e,i.width="0",i.height="0",i.style="display:none",i.onload=t,i.onerror=n,document.body.appendChild(i)})},c.decode=function(e){let t=document.createElement("div");return t.innerHTML=e,0===t.childNodes.length?"":t.childNodes[0].nodeValue},c.listen=function(e,t){i.a.listen(e,t)},c.send=function(e,t){i.a.send(e,t)},c.is_valid_url=function(e){try{return new URL(e),!0}catch(e){return!1}},c.done=function(e){throw c.log(e),e},t.default=c},function(e,t,n){"use strict";t.a=new class{constructor(){this.queue={},this.$element=document.createElement("template")}send(e,t){e in this.queue||(this.queue[e]=[]),this.queue[e].push({name:e,data:t}),this.$element.dispatchEvent(new CustomEvent(e,{detail:t}))}listen(e,t){e in this.queue&&this.queue[e].forEach(function(e){t(e.data)}),this.$element.addEventListener(e,function(e){t(e.detail)})}}},function(e,t,n){"use strict";var i=function(){var e={a:"aⓐａẚàáâầấẫẩãāăằắẵẳȧǡäǟảåǻǎȁȃạậặḁąⱥɐ",aa:"ꜳ",ae:"æǽǣ",ao:"ꜵ",au:"ꜷ",av:"ꜹꜻ",ay:"ꜽ",b:"bⓑｂḃḅḇƀƃɓ",c:"cⓒｃćĉċčçḉƈȼꜿↄ",d:"dⓓｄḋďḍḑḓḏđƌɖɗꝺ",dz:"ǳǆ",e:"eⓔｅèéêềếễểẽēḕḗĕėëẻěȅȇẹệȩḝęḙḛɇɛǝ",f:"fⓕｆḟƒꝼ",g:"gⓖｇǵĝḡğġǧģǥɠꞡᵹꝿ",h:"hⓗｈĥḣḧȟḥḩḫẖħⱨⱶɥ",hv:"ƕ",i:"iⓘｉìíîĩīĭïḯỉǐȉȋịįḭɨı",j:"jⓙｊĵǰɉ",k:"kⓚｋḱǩḳķḵƙⱪꝁꝃꝅꞣ",l:"lⓛｌŀĺľḷḹļḽḻſłƚɫⱡꝉꞁꝇ",lj:"ǉ",m:"mⓜｍḿṁṃɱɯ",n:"nⓝｎǹńñṅňṇņṋṉƞɲŉꞑꞥ",nj:"ǌ",o:"oⓞｏòóôồốỗổõṍȭṏōṑṓŏȯȱöȫỏőǒȍȏơờớỡởợọộǫǭøǿɔꝋꝍɵ",oi:"ƣ",ou:"ȣ",oo:"ꝏ",p:"pⓟｐṕṗƥᵽꝑꝓꝕ",q:"qⓠｑɋꝗꝙ",r:"rⓡｒŕṙřȑȓṛṝŗṟɍɽꝛꞧꞃ",s:"sⓢｓśṥŝṡšṧṣṩșşȿꞩꞅẛ",ss:"ß",t:"tⓣｔṫẗťṭțţṱṯŧƭʈⱦꞇ",tz:"ꜩ",u:"uⓤｕùúûũṹūṻŭüǜǘǖǚủůűǔȕȗưừứữửựụṳųṷṵʉ",v:"vⓥｖṽṿʋꝟʌ",vy:"ꝡ",w:"wⓦｗẁẃŵẇẅẘẉⱳ",x:"xⓧｘẋẍ",y:"yⓨｙỳýŷỹȳẏÿỷẙỵƴɏỿ",z:"zⓩｚźẑżžẓẕƶȥɀⱬꝣ"},t={};for(var n in e)for(var i=e[n].split(""),r=0;r<i.length;++r)t[i[r]]=n;return t}();let r={minLength:2,substrings:!0,normalize:function(e){return function(e){for(var t=e.split(""),n="",r=0;r<t.length;++r){var o=t[r];n+=o in i?i[o]:o}return n}(e.toLowerCase())},split:function(e){return e.split(/[-\s,;:\.\/\\\{\}\[\]\(\)<>|!\?"'^#\+~\*\$%`´&§=@€»«¢„“”]+/)}};t.a=new class{constructor(e){this.options=r}find(e){var t=this.wordsOf(e);if(0===t.length)return[];t.sort(function(e,t){return t.length-e.length});var n=this.index,i=Object.prototype.hasOwnProperty,r=t[0];if(!i.call(n,r))return[];var o={};for(var s in n[r])o[s]=!0;for(var a=1;a<t.length;++a){if(r=t[a],!i.call(n,r))return[];var c=n[r];for(var s in o)i.call(c,s)||delete o[s]}return Object.keys(o)}add(e,t){var n=this.options.substrings?this.substringsOf(t):this.wordsOf(t);if(0===n.length)return!1;for(var i=this.index,r=Object.prototype.hasOwnProperty,o=0;o<n.length;++o){var s=n[o];(r.call(i,s)?i[s]:i[s]={})[e]=!0}return!0}remove(e){var t=this.index;for(var n in t)delete t[n][e]}clear(){this.index={}}wordsOf(e){var t=e.trim();if(!t)return[];var n=this.options.minLength,i={},r=Object.prototype.hasOwnProperty;return this.options.split(this.options.normalize(t)).filter(function(e){return!(e.length<n||r.call(i,e)||(i[e]=!0,0))})}substringsOf(e){for(var t=this.options.minLength,n=(Object.prototype.hasOwnProperty,this.wordsOf(e)),i={},r=0;r<n.length;++r)for(var o=n[r],s=o.length,a=s;a>=t;--a)for(var c=0,u=s-a;c<=u;++c)i[o.slice(c,c+a)]=!0;return Object.keys(i)}toJSON(){var e={},t=this.index;for(var n in t)e[n]=Object.keys(t[n]);return e}toString(){return JSON.stringify(this.toJSON())}dump(){return this.toString()}load(e){var t=e,n={};if("object"!=typeof t||null===t)throw new TypeError("invalid JSON data");for(var e in t){var i=t[e];if(!Array.isArray(i))throw new TypeError("invalid JSON data");for(var r={},o=0;o<i.length;++o){var s=i[o];if("string"!=typeof s)throw new TypeError("invalid JSON data");r[s]=!0}n[e]=r}this.index=n}}},function(e,t,n){var i;
/**
 * @license Copyright 2013 Logentries.
 * Please view license at https://raw.github.com/logentries/le_js/master/LICENSE
 */
/**
 * @license Copyright 2013 Logentries.
 * Please view license at https://raw.github.com/logentries/le_js/master/LICENSE
 */
!function(r,o){void 0===(i=function(){return o(r)}.call(t,n,t,e))||(e.exports=i)}(this,function(e){"use strict";function t(t){var n,i=(Math.random()+Math.PI).toString(36).substring(2,10),r=t.trace,o=t.page_info,s=t.token,a=t.print;n=e.LEENDPOINT?e.LEENDPOINT:"js.logentries.com/v1";var c="undefined"==typeof XDomainRequest?t.ssl:"https:"===e.location.protocol,u=[],l=!1,f=!1;if(t.catchall){var h=e.onerror;e.onerror=function(e,t,n){return d({error:e,line:n,location:t}).level("ERROR").send(),!!h&&h(e,t,n)}}var d=function(t){var n=function(){var e=Array.prototype.slice.call(arguments);if(0===e.length)throw new Error("No arguments!");return 1===e.length?e[0]:e}.apply(this,arguments),c={event:n};return"never"!==o&&(f&&"per-entry"!==o||(f=!0,void 0===n.screen&&void 0===n.browser&&d(function(){var t=e.navigator||{doNotTrack:void 0},n=e.screen||{};return{url:(e.location||{}).pathname,referrer:document.referrer,screen:{width:n.width,height:n.height},window:{width:e.innerWidth,height:e.innerHeight},browser:{name:t.appName,version:t.appVersion,cookie_enabled:t.cookieEnabled,do_not_track:t.doNotTrack},platform:t.platform}}()).level("PAGE").send())),r&&(c.trace=i),{level:function(e){if(a&&"undefined"!=typeof console&&"PAGE"!==e)try{console[e.toLowerCase()].call(console,c)}catch(e){console.log(c)}return c.level=e,{send:function(){var e=[],t=JSON.stringify(c,function(t,n){if(void 0===n)return"undefined";if("object"==typeof n&&null!==n){if(-1!==function(e,t){for(var n=0;n<e.length;n++)if(t===e[n])return n;return-1}(e,n))return"<?>";e.push(n)}return n});l?u.push(t):p(s,t)}}}}};this.log=d;var p=function(e,t){l=!0;var i="undefined"!=typeof XDomainRequest?new XDomainRequest:new XMLHttpRequest;i.constructor===XMLHttpRequest?i.onreadystatechange=function(){4===i.readyState&&(i.status>=400?(console.error("Couldn't submit events."),410===i.status&&console.warn("This version of le_js is no longer supported!")):(301===i.status&&console.warn("This version of le_js is deprecated! Consider upgrading."),u.length>0?p(e,u.shift()):l=!1))}:i.onload=function(){u.length>0?p(e,u.shift()):l=!1};var r=(c?"https://":"http://")+n+"/logs/"+s;i.open("POST",r,!0),i.constructor===XMLHttpRequest&&(i.setRequestHeader("X-Requested-With","XMLHttpRequest"),i.setRequestHeader("Content-type","text/json")),i.send(t)}}var n={},i=function(e){if("string"!=typeof e.name)throw new Error("Name not present.");if(n.hasOwnProperty(e.name))throw new Error("A logger with that name already exists!");return n[e.name]=new function(e){var n,i={ssl:!0,catchall:!1,trace:!0,page_info:"never",print:!1,endpoint:null,token:null};if("object"!=typeof e)throw new Error("Invalid parameters for createLogStream()");for(var r in e)i[r]=e[r];if(null===i.token)throw new Error("Token not present.");n=new t(i);var o=function(e){if(n)return n.log.apply(this,arguments);throw new Error("You must call LE.init(...) first.")};return{log:function(){o.apply(this,arguments).level("LOG").send()},warn:function(){o.apply(this,arguments).level("WARN").send()},error:function(){o.apply(this,arguments).level("ERROR").send()},info:function(){o.apply(this,arguments).level("INFO").send()}}}(e),!0};return{init:function(e){var t={name:"default"};if("object"==typeof e)for(var n in e)t[n]=e[n];else{if("string"!=typeof e)throw new Error("Invalid parameters for init()");t.token=e}return i(t)},createLogStream:i,to:function(e){if(!n.hasOwnProperty(e))throw new Error("Invalid name for logStream");return n[e]},destroy:function(e){void 0===e&&(e="default"),delete n[e]},log:function(){for(var e in n)n[e].log.apply(this,arguments)},warn:function(){for(var e in n)n[e].warn.apply(this,arguments)},error:function(){for(var e in n)n[e].error.apply(this,arguments)},info:function(){for(var e in n)n[e].info.apply(this,arguments)}}})},function(e,t,n){var i,r,o;!function(s,a){"use strict";r=[n(12)],void 0===(o="function"==typeof(i=a)?i.apply(t,r):i)||(e.exports=o)}(0,function(e){"use strict";var t=/(^|@)\S+\:\d+/,n=/^\s*at .*(\S+\:\d+|\(native\))/m,i=/^(eval@)?(\[native code\])?$/;return{parse:function(e){if(void 0!==e.stacktrace||void 0!==e["opera#sourceloc"])return this.parseOpera(e);if(e.stack&&e.stack.match(n))return this.parseV8OrIE(e);if(e.stack)return this.parseFFOrSafari(e);throw new Error("Cannot parse given Error object")},extractLocation:function(e){if(-1===e.indexOf(":"))return[e];var t=/(.+?)(?:\:(\d+))?(?:\:(\d+))?$/.exec(e.replace(/[\(\)]/g,""));return[t[1],t[2]||void 0,t[3]||void 0]},parseV8OrIE:function(t){return t.stack.split("\n").filter(function(e){return!!e.match(n)},this).map(function(t){t.indexOf("(eval ")>-1&&(t=t.replace(/eval code/g,"eval").replace(/(\(eval at [^\()]*)|(\)\,.*$)/g,""));var n=t.replace(/^\s+/,"").replace(/\(eval code/g,"(").split(/\s+/).slice(1),i=this.extractLocation(n.pop()),r=n.join(" ")||void 0,o=["eval","<anonymous>"].indexOf(i[0])>-1?void 0:i[0];return new e({functionName:r,fileName:o,lineNumber:i[1],columnNumber:i[2],source:t})},this)},parseFFOrSafari:function(t){return t.stack.split("\n").filter(function(e){return!e.match(i)},this).map(function(t){if(t.indexOf(" > eval")>-1&&(t=t.replace(/ line (\d+)(?: > eval line \d+)* > eval\:\d+\:\d+/g,":$1")),-1===t.indexOf("@")&&-1===t.indexOf(":"))return new e({functionName:t});var n=t.split("@"),i=this.extractLocation(n.pop()),r=n.join("@")||void 0;return new e({functionName:r,fileName:i[0],lineNumber:i[1],columnNumber:i[2],source:t})},this)},parseOpera:function(e){return!e.stacktrace||e.message.indexOf("\n")>-1&&e.message.split("\n").length>e.stacktrace.split("\n").length?this.parseOpera9(e):e.stack?this.parseOpera11(e):this.parseOpera10(e)},parseOpera9:function(t){for(var n=/Line (\d+).*script (?:in )?(\S+)/i,i=t.message.split("\n"),r=[],o=2,s=i.length;o<s;o+=2){var a=n.exec(i[o]);a&&r.push(new e({fileName:a[2],lineNumber:a[1],source:i[o]}))}return r},parseOpera10:function(t){for(var n=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,i=t.stacktrace.split("\n"),r=[],o=0,s=i.length;o<s;o+=2){var a=n.exec(i[o]);a&&r.push(new e({functionName:a[3]||void 0,fileName:a[2],lineNumber:a[1],source:i[o]}))}return r},parseOpera11:function(n){return n.stack.split("\n").filter(function(e){return!!e.match(t)&&!e.match(/^Error created at/)},this).map(function(t){var n,i=t.split("@"),r=this.extractLocation(i.pop()),o=i.shift()||"",s=o.replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^\)]*\)/g,"")||void 0;o.match(/\(([^\)]*)\)/)&&(n=o.replace(/^[^\(]+\(([^\)]*)\)$/,"$1"));var a=void 0===n||"[arguments not available]"===n?void 0:n.split(",");return new e({functionName:s,args:a,fileName:r[0],lineNumber:r[1],columnNumber:r[2],source:t})},this)}}})},function(e,t,n){var i,r,o;!function(n,s){"use strict";r=[],void 0===(o="function"==typeof(i=s)?i.apply(t,r):i)||(e.exports=o)}(0,function(){"use strict";function e(e){return!isNaN(parseFloat(e))&&isFinite(e)}function t(e){return e.charAt(0).toUpperCase()+e.substring(1)}function n(e){return function(){return this[e]}}var i=["isConstructor","isEval","isNative","isToplevel"],r=["columnNumber","lineNumber"],o=["fileName","functionName","source"],s=i.concat(r,o,["args"],["evalOrigin"]);function a(e){if(e)for(var n=0;n<s.length;n++)void 0!==e[s[n]]&&this["set"+t(s[n])](e[s[n]])}a.prototype={getArgs:function(){return this.args},setArgs:function(e){if("[object Array]"!==Object.prototype.toString.call(e))throw new TypeError("Args must be an Array");this.args=e},getEvalOrigin:function(){return this.evalOrigin},setEvalOrigin:function(e){if(e instanceof a)this.evalOrigin=e;else{if(!(e instanceof Object))throw new TypeError("Eval Origin must be an Object or StackFrame");this.evalOrigin=new a(e)}},toString:function(){var e=this.getFileName()||"",t=this.getLineNumber()||"",n=this.getColumnNumber()||"",i=this.getFunctionName()||"";return this.getIsEval()?e?"[eval] ("+e+":"+t+":"+n+")":"[eval]:"+t+":"+n:i?i+" ("+e+":"+t+":"+n+")":e+":"+t+":"+n}},a.fromString=function(e){var t=e.indexOf("("),n=e.lastIndexOf(")"),i=e.substring(0,t),r=e.substring(t+1,n).split(","),o=e.substring(n+1);if(0===o.indexOf("@"))var s=/@(.+?)(?::(\d+))?(?::(\d+))?$/.exec(o,""),c=s[1],u=s[2],l=s[3];return new a({functionName:i,args:r||void 0,fileName:c,lineNumber:u||void 0,columnNumber:l||void 0})};for(var c=0;c<i.length;c++)a.prototype["get"+t(i[c])]=n(i[c]),a.prototype["set"+t(i[c])]=function(e){return function(t){this[e]=Boolean(t)}}(i[c]);for(var u=0;u<r.length;u++)a.prototype["get"+t(r[u])]=n(r[u]),a.prototype["set"+t(r[u])]=function(t){return function(n){if(!e(n))throw new TypeError(t+" must be a Number");this[t]=Number(n)}}(r[u]);for(var l=0;l<o.length;l++)a.prototype["get"+t(o[l])]=n(o[l]),a.prototype["set"+t(o[l])]=function(e){return function(t){this[e]=String(t)}}(o[l]);return a})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=function(e){return e&&e.__esModule?e:{default:e}}(n(0)),o=n(3);var s=window.location.protocol+"//chicoryapp.com",a="below-ingredient",c="below-ingredients",u="below-recipe",l="custom",f="none",h=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.settings={},this.device={},this.session=null,this.funnel=null,this.$pairing=null,this.$inlines=[],this.allowed_inlines=2,this.allowed_pairing=1,this.ad_refresh_count=1,this.ad_refresh_timer=null,this.original_settings=null,this._bound_device_init_listener=null}return i(e,[{key:"deactivate",value:function(){this.$pairing&&this.$pairing.remove(),r.default.each(this.$inlines,function(e,t){t.remove()}),this.settings={},this.device={},this.session=null,this.funnel=null,this.$pairing=null,this.$inlines=[],window.removeEventListener("message",this._bound_device_init_listener),this._bound_device_init_listener=null}},{key:"activate",value:function(e){this.original_settings=e,e.recipes||this.load(e).then(this.run.bind(this)).catch(r.default.done)}},{key:"load",value:function(e){var t=this;return new Promise(function(n){var i={host:e.host.id,recipe:e.recipe.id,zip_code:e.zip_code,dma_code:e.dma,state:e.state,country_code:e.country_code,is_mobile:e.is_mobile,refresh:t.ad_refresh_count};r.default.get(s+"/api/native",i).then(function(i){return r.default.extend(t.settings,e,i),n()}).catch(r.default.done),this._bound_device_init_listener=this._device_init_listener.bind(this),window.addEventListener("message",this._bound_device_init_listener,!1)}.bind(this))}},{key:"_device_init_listener",value:function(e){var t=new RegExp("e.chicoryapp.com".replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1"),"g");if(e.origin.match(t))try{var n=JSON.parse(e.data);"init"===n.caller&&(this.device=n.data.device,this.session=n.data.session,this.funnel=n.data.funnel)}catch(e){}}},{key:"reached_pairing_limit",value:function(){return!!(this.$pairing&&this.$pairing.length>=this.allowed_pairing)}},{key:"reached_inline_limit",value:function(){return!!(this.$inlines&&this.$inlines.length>=this.allowed_inlines)}},{key:"run",value:function(){for(var e=r.default.getPageStructure(),t=0,n=this.settings.ad_campaigns.length-1;n>0;n--){var i=Math.floor(Math.random()*(n+1)),o=[this.settings.ad_campaigns[i],this.settings.ad_campaigns[n]];this.settings.ad_campaigns[n]=o[0],this.settings.ad_campaigns[i]=o[1]}this.settings.ad_campaigns.sort(function(e,t){return e.priority<t.priority?1:-1}),r.default.each(this.settings.ad_campaigns,function(n,i){return!(this.settings.host.ad_campaign_limit&&t++>=this.settings.host.ad_campaign_limit)&&(("below-ingredient"!=i.selected_experiment.placement||!this.reached_inline_limit())&&(("below-ingredients"!=i.selected_experiment.placement||!this.reached_pairing_limit())&&void(this.injectCreative(e,i,i.selected_experiment.placement)||r.default.log(new Error("Chicory: Cannot inject ad creative (ID:"+i.selected_experiment.id+", LOCATION:"+i.selected_experiment.placement+").")))))}.bind(this)),this.handle_ad_refresh()}},{key:"is_serving_ads",value:function(){return(this.$inlines?this.$inlines.length:0)+(this.$pairing?this.$pairing.length:0)>0}},{key:"reached_refresh_limit",value:function(){return!(!this.settings.host.ad_refresh_limit||0===this.settings.host.ad_refresh_limit)&&(this.settings.host.ad_refresh_limit>0&&this.ad_refresh_count>=this.settings.host.ad_refresh_limit)}},{key:"is_in_viewport",value:function(e){for(var t=e.offsetTop,n=e.offsetLeft,i=e.offsetWidth,r=e.offsetHeight;e.offsetParent;)t+=(e=e.offsetParent).offsetTop,n+=e.offsetLeft;return t<window.pageYOffset+window.innerHeight&&n<window.pageXOffset+window.innerWidth&&t+r>window.pageYOffset&&n+i>window.pageXOffset}},{key:"is_any_ad_unit_in_viewport",value:function(){for(var e=0;e<this.$inlines.length;e++)for(var t=0;t<this.$inlines.length;t++)if(this.$inlines[e].elements[t]&&this.is_in_viewport(this.$inlines[e].elements[t]))return!0;return!(!(this.$pairing?this.$pairing.length:0)||!this.is_in_viewport(this.$pairing.elements[0]))}},{key:"refresh_ads",value:function(){var e=this.device,t=this.session,n=this.funnel;this.deactivate(),this.activate(this.original_settings),this.device=e,this.session=t,this.funnel=n}},{key:"ad_refresh_set_timer",value:function(){var e=this;return setTimeout(function(){e.is_any_ad_unit_in_viewport()?e.refresh_ads():e.ad_refresh_timer=e.ad_refresh_set_timer()},1e3*this.settings.host.ad_refresh_seconds)}},{key:"handle_ad_refresh",value:function(){var e=this;this.settings.host.ad_refresh_active&&!this.reached_refresh_limit()?this.ad_refresh_timer=this.ad_refresh_set_timer():this.ad_refresh_timer=null,this.is_serving_ads()&&(this.ad_refresh_count+=1);var t=void 0;void 0!==document.hidden?t="hidden":void 0!==document.msHidden?t="msHidden":void 0!==document.webkitHidden&&(t="webkitHidden"),document.addEventListener("visibilitychange",function(){document[t]?clearTimeout(e.ad_refresh_timer):e.ad_refresh_timer=e.ad_refresh_set_timer()})}},{key:"injectCreative",value:function(e,t,n){var i=(0,r.default)(t.selected_experiment.html);if(i.firstViewed=!1,!document.getElementById(i.elements[0].id)){var s=(0,r.default)("div.chicory-peek").viewable();s.length&&(n=l);var h=!t.selected_experiment.placement;switch(n){case a:var d=[];if(t.matched_ingredient_line&&(d=r.default.fulltext(e.ingredients,t.matched_ingredient_line,t.matched_ingredient)),!d.length&&t.matched_ingredient_line&&(d=r.default.fulltext(e.ingredients,r.default.decode(t.matched_ingredient_line),t.matched_ingredient)),!d.length&&t.matched_ingredient_line&&(d=r.default.fulltext((0,r.default)("ul").viewable(),t.matched_ingredient_line,t.matched_ingredient)),!d.length)return this.injectCreative(e,t,h?c:f);if(this.$inlines.length>=3)return this.injectCreative(e,t,h?c:f);d.append(i),this.$inlines.push(i);break;case c:var p=e.ingredients;if(!p.length)return this.injectCreative(e,t,h?u:f);if(this.$pairing)return this.injectCreative(e,t,h?u:f);p.append(i),this.$pairing=i;break;case u:var g=e.recipe;if(!g.length)return this.injectCreative(e,t,f);if(this.$pairing)return this.injectCreative(e,t,f);g.append(i),this.$pairing=i;break;case l:if(!s.length)return this.injectCreative(e,t,f);if(this.$pairing)return this.injectCreative(e,t,f);s.append(i),this.$pairing=i;break;case f:return;default:return this.injectCreative(e,t,a)}var v=i.parent().width();v<i.width()&&i.width(v),v<150&&i.hide();var m={ad_campaign_id:t.id,ad_campaign_name:t.name,ad_campaign_test_id:t.selected_experiment.id,ad_campaign_test_name:t.selected_experiment.name,ad_campaign_group_id:t.group.id,ad_campaign_group_name:t.group.name,ad_campaign_width:i.width(),ad_campaign_height:i.height(),parent_width:i.parent().width(),parent_height:i.parent().height(),ad_not_shown:!i.viewable().length,location:n,zip_code:t.zip_code,ad_refresh_count:this.ad_refresh_count},_=(0,o.v4)();return m.funnel_id=_,i.on("view",function(e){var n=t.selected_experiment.impression_tracker;if(n){for(n="<div>"+n+"</div>";null!==n.match(/\[RANDOM_NUMBER]/g);)n=n.replace(/\[RANDOM_NUMBER]/,Math.random());var o=(0,r.default)(n);i.after(o.css("display","none"))}var s=t.selected_experiment.script_tracker,a=/<script[a-z1-9"'\/ =]*?src="(.*?)"/gim;if(s&&!i.firstViewed){for(var c=void 0;null!==(c=a.exec(s));){c.index===a.lastIndex&&a.lastIndex++;var u=document.createElement("script");u.type="text/javascript",u.src=c[1],r.default.each(i.elements,function(e,t){t.appendChild(u)})}i.firstViewed=!0}r.default.send("view_campaign",m)}.bind(this)),i.on("click",function(e){e.preventDefault();var n=t.selected_experiment.target_url,i=n.indexOf("http")<0?window.location.protocol+"//"+n:n,o=this.generate_redirect_hash(m,i,"click_campaign");r.default.goto("//e.chicoryapp.com/api/r?data="+o)}.bind(this)),r.default.send("load_campaign",m),console.log("Chicory: injecting native creative at location: "+n),n}}},{key:"generate_redirect_hash",value:function(e,t,n){var i={url:t,is_mobile:this.settings.is_mobile};for(var o in e)e.hasOwnProperty(o)&&(i[o]=e[o]);var s=new Date((new Date).toUTCString()).getTime(),a={uuid:this.device.uuid,session_id:this.session.id,funnel_id:e.funnel_id,name:n,recipe_id:this.settings.recipe.id,viewport_height:(0,r.default)(window.document).height(),viewport_width:(0,r.default)(window.document).width(),language:window.navigator.language||navigator.userLanguage,encoding:window.document.characterSet||window.document.defaultCharset,url:window.document.location.href,referrer:window.document.referrer,duration:s-(window.performance?window.performance.timing.domContentLoadedEventEnd:LOAD_TIME),client_timestamp:s,properties:r.default.extend({},this.device.properties,this.session.properties,this.funnel.properties,i||{})};delete a.properties.funnel_id;var c=JSON.stringify(a);return btoa(c)}},{key:"generate_redirect_form",value:function(e,t){var n=document.createElement("form"),i=function(e,t){n.setAttribute(e,t)};i("enctype","application/json"),i("method","post"),i("action","http://e.chicoryapp.com/api/event"),i("target","_blank");var r=function(e,t){var i=document.createElement("input");i.setAttribute("type","hidden"),i.setAttribute("name",e),i.setAttribute("value",t),n.appendChild(i)};return r("data",JSON.stringify(e)),r("redirect",t),n}}]),e}();t.default=new h},function(e,t,n){"use strict";var i,r,o=n(4),s=n(1),a=0,c=0;t.a=function(e,t,n){var u=t&&n||0,l=t||[],f=(e=e||{}).node||i,h=void 0!==e.clockseq?e.clockseq:r;if(null==f||null==h){var d=e.random||(e.rng||o.a)();null==f&&(f=i=[1|d[0],d[1],d[2],d[3],d[4],d[5]]),null==h&&(h=r=16383&(d[6]<<8|d[7]))}var p=void 0!==e.msecs?e.msecs:(new Date).getTime(),g=void 0!==e.nsecs?e.nsecs:c+1,v=p-a+(g-c)/1e4;if(v<0&&void 0===e.clockseq&&(h=h+1&16383),(v<0||p>a)&&void 0===e.nsecs&&(g=0),g>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");a=p,c=g,r=h;var m=(1e4*(268435455&(p+=122192928e5))+g)%4294967296;l[u++]=m>>>24&255,l[u++]=m>>>16&255,l[u++]=m>>>8&255,l[u++]=255&m;var _=p/4294967296*1e4&268435455;l[u++]=_>>>8&255,l[u++]=255&_,l[u++]=_>>>24&15|16,l[u++]=_>>>16&255,l[u++]=h>>>8|128,l[u++]=255&h;for(var y=0;y<6;++y)l[u+y]=f[y];return t||Object(s.a)(l)}},function(e,t,n){"use strict";var i=n(5),r=n(16),o=Object(i.a)("v3",48,r.a);t.a=o},function(e,t,n){"use strict";function i(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function r(e,t,n,r,o,s){return i(function(e,t){return e<<t|e>>>32-t}(i(i(t,e),i(r,s)),o),n)}function o(e,t,n,i,o,s,a){return r(t&n|~t&i,e,t,o,s,a)}function s(e,t,n,i,o,s,a){return r(t&i|n&~i,e,t,o,s,a)}function a(e,t,n,i,o,s,a){return r(t^n^i,e,t,o,s,a)}function c(e,t,n,i,o,s,a){return r(n^(t|~i),e,t,o,s,a)}t.a=function(e){if("string"==typeof e){var t=unescape(encodeURIComponent(e));e=new Array(t.length);for(var n=0;n<t.length;n++)e[n]=t.charCodeAt(n)}return function(e){var t,n,i,r=[],o=32*e.length;for(t=0;t<o;t+=8)n=e[t>>5]>>>t%32&255,i=parseInt("0123456789abcdef".charAt(n>>>4&15)+"0123456789abcdef".charAt(15&n),16),r.push(i);return r}(function(e,t){var n,r,u,l,f;e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;var h=1732584193,d=-271733879,p=-1732584194,g=271733878;for(n=0;n<e.length;n+=16)r=h,u=d,l=p,f=g,h=o(h,d,p,g,e[n],7,-680876936),g=o(g,h,d,p,e[n+1],12,-389564586),p=o(p,g,h,d,e[n+2],17,606105819),d=o(d,p,g,h,e[n+3],22,-1044525330),h=o(h,d,p,g,e[n+4],7,-176418897),g=o(g,h,d,p,e[n+5],12,1200080426),p=o(p,g,h,d,e[n+6],17,-1473231341),d=o(d,p,g,h,e[n+7],22,-45705983),h=o(h,d,p,g,e[n+8],7,1770035416),g=o(g,h,d,p,e[n+9],12,-1958414417),p=o(p,g,h,d,e[n+10],17,-42063),d=o(d,p,g,h,e[n+11],22,-1990404162),h=o(h,d,p,g,e[n+12],7,1804603682),g=o(g,h,d,p,e[n+13],12,-40341101),p=o(p,g,h,d,e[n+14],17,-1502002290),d=o(d,p,g,h,e[n+15],22,1236535329),h=s(h,d,p,g,e[n+1],5,-165796510),g=s(g,h,d,p,e[n+6],9,-1069501632),p=s(p,g,h,d,e[n+11],14,643717713),d=s(d,p,g,h,e[n],20,-373897302),h=s(h,d,p,g,e[n+5],5,-701558691),g=s(g,h,d,p,e[n+10],9,38016083),p=s(p,g,h,d,e[n+15],14,-660478335),d=s(d,p,g,h,e[n+4],20,-405537848),h=s(h,d,p,g,e[n+9],5,568446438),g=s(g,h,d,p,e[n+14],9,-1019803690),p=s(p,g,h,d,e[n+3],14,-187363961),d=s(d,p,g,h,e[n+8],20,1163531501),h=s(h,d,p,g,e[n+13],5,-1444681467),g=s(g,h,d,p,e[n+2],9,-51403784),p=s(p,g,h,d,e[n+7],14,1735328473),d=s(d,p,g,h,e[n+12],20,-1926607734),h=a(h,d,p,g,e[n+5],4,-378558),g=a(g,h,d,p,e[n+8],11,-2022574463),p=a(p,g,h,d,e[n+11],16,1839030562),d=a(d,p,g,h,e[n+14],23,-35309556),h=a(h,d,p,g,e[n+1],4,-1530992060),g=a(g,h,d,p,e[n+4],11,1272893353),p=a(p,g,h,d,e[n+7],16,-155497632),d=a(d,p,g,h,e[n+10],23,-1094730640),h=a(h,d,p,g,e[n+13],4,681279174),g=a(g,h,d,p,e[n],11,-358537222),p=a(p,g,h,d,e[n+3],16,-722521979),d=a(d,p,g,h,e[n+6],23,76029189),h=a(h,d,p,g,e[n+9],4,-640364487),g=a(g,h,d,p,e[n+12],11,-421815835),p=a(p,g,h,d,e[n+15],16,530742520),d=a(d,p,g,h,e[n+2],23,-995338651),h=c(h,d,p,g,e[n],6,-198630844),g=c(g,h,d,p,e[n+7],10,1126891415),p=c(p,g,h,d,e[n+14],15,-1416354905),d=c(d,p,g,h,e[n+5],21,-57434055),h=c(h,d,p,g,e[n+12],6,1700485571),g=c(g,h,d,p,e[n+3],10,-1894986606),p=c(p,g,h,d,e[n+10],15,-1051523),d=c(d,p,g,h,e[n+1],21,-2054922799),h=c(h,d,p,g,e[n+8],6,1873313359),g=c(g,h,d,p,e[n+15],10,-30611744),p=c(p,g,h,d,e[n+6],15,-1560198380),d=c(d,p,g,h,e[n+13],21,1309151649),h=c(h,d,p,g,e[n+4],6,-145523070),g=c(g,h,d,p,e[n+11],10,-1120210379),p=c(p,g,h,d,e[n+2],15,718787259),d=c(d,p,g,h,e[n+9],21,-343485551),h=i(h,r),d=i(d,u),p=i(p,l),g=i(g,f);return[h,d,p,g]}(function(e){var t,n=[];for(n[(e.length>>2)-1]=void 0,t=0;t<n.length;t+=1)n[t]=0;var i=8*e.length;for(t=0;t<i;t+=8)n[t>>5]|=(255&e[t/8])<<t%32;return n}(e),8*e.length))}},function(e,t,n){"use strict";var i=n(4),r=n(1);t.a=function(e,t,n){var o=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var s=(e=e||{}).random||(e.rng||i.a)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t)for(var a=0;a<16;++a)t[o+a]=s[a];return t||Object(r.a)(s)}},function(e,t,n){"use strict";var i=n(5),r=n(19),o=Object(i.a)("v5",80,r.a);t.a=o},function(e,t,n){"use strict";function i(e,t,n,i){switch(e){case 0:return t&n^~t&i;case 1:return t^n^i;case 2:return t&n^t&i^n&i;case 3:return t^n^i}}function r(e,t){return e<<t|e>>>32-t}t.a=function(e){var t=[1518500249,1859775393,2400959708,3395469782],n=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof e){var o=unescape(encodeURIComponent(e));e=new Array(o.length);for(var s=0;s<o.length;s++)e[s]=o.charCodeAt(s)}e.push(128);var a=e.length/4+2,c=Math.ceil(a/16),u=new Array(c);for(s=0;s<c;s++){u[s]=new Array(16);for(var l=0;l<16;l++)u[s][l]=e[64*s+4*l]<<24|e[64*s+4*l+1]<<16|e[64*s+4*l+2]<<8|e[64*s+4*l+3]}for(u[c-1][14]=8*(e.length-1)/Math.pow(2,32),u[c-1][14]=Math.floor(u[c-1][14]),u[c-1][15]=8*(e.length-1)&4294967295,s=0;s<c;s++){for(var f=new Array(80),h=0;h<16;h++)f[h]=u[s][h];for(h=16;h<80;h++)f[h]=r(f[h-3]^f[h-8]^f[h-14]^f[h-16],1);var d=n[0],p=n[1],g=n[2],v=n[3],m=n[4];for(h=0;h<80;h++){var _=Math.floor(h/20),y=r(d,5)+i(_,p,g,v)+m+t[_]+f[h]>>>0;m=v,v=g,g=r(p,30)>>>0,p=d,d=y}n[0]=n[0]+d>>>0,n[1]=n[1]+p>>>0,n[2]=n[2]+g>>>0,n[3]=n[3]+v>>>0,n[4]=n[4]+m>>>0}return[n[0]>>24&255,n[0]>>16&255,n[0]>>8&255,255&n[0],n[1]>>24&255,n[1]>>16&255,n[1]>>8&255,255&n[1],n[2]>>24&255,n[2]>>16&255,n[2]>>8&255,255&n[2],n[3]>>24&255,n[3]>>16&255,n[3]>>8&255,255&n[3],n[4]>>24&255,n[4]>>16&255,n[4]>>8&255,255&n[4]]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=function(e){return e&&e.__esModule?e:{default:e}}(n(0)),o=n(3),s=n(21);var a=window.location.protocol+"//adserver.us-east1.prod.chicoryapp.com",c=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.settings={},this.device={},this.session=null,this.funnel=null,this.$pairing=null,this.$inlines=[],this.blocked_ids=[],this.allowed_inlines=2,this.allowed_pairing=1,this.ad_refresh_count=1,this.ad_refresh_timer=null,this.original_settings=null,this._bound_device_init_listener=null}return i(e,[{key:"deactivate",value:function(){this.$pairing&&this.$pairing.remove(),r.default.each(this.$inlines,function(e,t){t.remove()}),this.settings={},this.device={},this.session=null,this.funnel=null,this.$pairing=null,this.$inlines=[],this.blocked_ids=[],window.removeEventListener("message",this._bound_device_init_listener),this._bound_device_init_listener=null}},{key:"activate",value:function(e){this.original_settings=e,e.recipes||this.load(e).then(this.run.bind(this)).catch(r.default.done)}},{key:"load",value:function(e){var t=r.default.getPageStructure(),n=this;return r.default.extend(n.settings,e),new Promise(function(e){var i={inline_slots:{},pairing_slot:{}},o=n._get_inline_slots(r.default.getPageStructure(),this.settings.recipe.ingredient_lines);return i.inline_slots=o,i.pairing_slot={unit_type:"pairing",slot:n._get_pairing_slot(t),targeting:{ingredient:n._get_pairing_ingredients(this.settings.recipe.ingredient_lines),name:this.settings.recipe.name}},r.default.extend(this.settings,{slots:i}),this._bound_device_init_listener=this._device_init_listener.bind(this),window.addEventListener("message",this._bound_device_init_listener,!1),e()}.bind(this))}},{key:"_get_pairing_slot",value:function(e){var t=e.ingredients,n=(0,r.default)("div.chicory-peek").viewable();return n.length?n:t}},{key:"_get_pairing_ingredients",value:function(e){var t=[];return r.default.each(e,function(e,n){t.push(n.ingredient_id)}),t}},{key:"_get_inline_slots",value:function(e,t){var n={},i={};return r.default.each(t,function(t,o){if(o.text&&o.ingredient_id){var s=r.default.fulltext(e.ingredients,o.text,o.ingredient_id);i[o.ingredient_id]||(i[o.ingredient_id]=!0,n[o.ingredient_id]={unit_type:"inline",slot:s,targeting:{text:o.text,ingredient:o.ingredient_id}})}}),n}},{key:"_device_init_listener",value:function(e){var t=new RegExp("e.chicoryapp.com".replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1"),"g");if(e.origin.match(t))try{var n=JSON.parse(e.data);"init"===n.caller&&(this.device=n.data.device,this.session=n.data.session,this.funnel=n.data.funnel)}catch(e){}}},{key:"inject",value:function(){var e=this,t=e._get_unit_request_payload(),n=e.settings.slots;r.default.get(a+"/api/native",t).then(function(t){r.default.each(t.selected_experiments,function(t,i){if("pairing"===i.ad_unit_type)e.inject_unit(n.pairing_slot,i);else if("inline"===i.ad_unit_type){var r=n.inline_slots[i.targeted_ingredient];e.inject_unit(r,i)}})})}},{key:"run",value:function(){this.inject(),this.handle_ad_refresh()}},{key:"_get_unit_request_payload",value:function(){var e=this.settings.host.id;document.referrer.indexOf("localhost:8451")>0||document.referrer.indexOf("staging-network.chicoryapp.com")>0||document.referrer.indexOf("qa-network.chicoryapp.com")>0||document.referrer.indexOf("prod-network.chicoryapp.com");var t=[];r.default.each(this.settings.recipe.ingredient_lines,function(e,n){t.push(n.ingredient_id)});var n=t.join(","),i=this.settings.host.excluded_tags.join(",");return{inline_ads:2,pairing_ads:1,user_zip_code:this.settings.zip_code,user_dma:this.settings.dma,user_state:this.settings.state,user_country:this.settings.country_code,user_device:this.settings.is_mobile?"Mobile":"Desktop",ad_refresh_count:this.ad_refresh_count,publisher_id:e,publisher_blocked_tags:i,ingredients:n,blocked_ids:this.blocked_ids,recipe_name:this.settings.recipe.name,restrict_ads:this.settings.host.restrict_ads,ad_campaign_limit:this.settings.host.ad_campaign_limit,placement:this.settings.host.placement}}},{key:"_get_hostname_from_url",value:function(e){var t=document.createElement("a");return t.href=this.settings.recipe.source_uri,t.hostname}},{key:"inject_unit",value:function(e,t){var n=e.slot.elements[0],i=(0,r.default)(t.html);if(i.firstViewed=!1,!i.elements[0].id||!document.getElementById(i.elements[0].id)){n.append(i.elements[0]),"pairing"===e.unit_type?this.$pairing=i:(this.$inlines.push(i),this.blocked_ids.push(t.id));var s=i.parent().width();s<i.width()&&i.width(s),s<150&&i.hide();var a={ad_campaign_test_id:t.id,ad_campaign_id:t.ad_campaign_id,ad_campaign_width:i.width(),ad_campaign_height:i.height(),parent_width:i.parent().width(),parent_height:i.parent().height(),ad_not_shown:!i.viewable().length,location:"pairing"===e.unit_type?"below-ingredients":"below-ingredient",ad_refresh_count:this.ad_refresh_count},c=(0,o.v4)();return a.funnel_id=c,i.on("view",function(e){var n=t.impression_tracker;if(n){for(n="<div>"+n+"</div>";null!==n.match(/\[RANDOM_NUMBER]/g);)n=n.replace(/\[RANDOM_NUMBER]/,Math.random());var o=(0,r.default)(n);i.after(o.css("display","none"))}var s=t.script_tracker,c=/<script[a-z1-9"'\/ =]*?src="(.*?)"/gim;if(s&&!i.firstViewed){for(var u=void 0;null!==(u=c.exec(s));){u.index===c.lastIndex&&c.lastIndex++;var l=document.createElement("script");l.type="text/javascript",l.src=u[1],r.default.each(i.elements,function(e,t){t.appendChild(l)})}i.firstViewed=!0}r.default.send("view_campaign",a)}.bind(this)),i.on("click",function(e){e.preventDefault();var n=t.target_url,i=n.indexOf("http")<0?window.location.protocol+"//"+n:n,o=this.generate_redirect_hash(a,i,"click_campaign");r.default.goto("//e.chicoryapp.com/api/r?data="+o)}.bind(this)),r.default.send("load_campaign",a),!0}console.log("Chicory: already injected")}},{key:"is_serving_ads",value:function(){return(this.$inlines?this.$inlines.length:0)+(this.$pairing?1:0)>0}},{key:"reached_refresh_limit",value:function(){return!(!this.settings.host.ad_refresh_limit||0===this.settings.host.ad_refresh_limit)&&(this.settings.host.ad_refresh_limit>0&&this.ad_refresh_count>=this.settings.host.ad_refresh_limit)}},{key:"is_in_viewport",value:function(e){for(var t=e.offsetTop,n=e.offsetLeft,i=e.offsetWidth,r=e.offsetHeight;e.offsetParent;)t+=(e=e.offsetParent).offsetTop,n+=e.offsetLeft;return t<window.pageYOffset+window.innerHeight&&n<window.pageXOffset+window.innerWidth&&t+r>window.pageYOffset&&n+i>window.pageXOffset}},{key:"is_any_ad_unit_in_viewport",value:function(){for(var e=0;e<this.$inlines.length;e++)for(var t=0;t<this.$inlines.length;t++)if(this.$inlines[e].elements[t]&&this.is_in_viewport(this.$inlines[e].elements[t]))return!0;return!(!(this.$pairing?this.$pairing.length:0)||!this.is_in_viewport(this.$pairing.elements[0]))}},{key:"refresh_ads",value:function(){var e=this.device,t=this.session,n=this.funnel;this.deactivate(),this.activate(this.original_settings),this.device=e,this.session=t,this.funnel=n}},{key:"ad_refresh_set_timer",value:function(){var e=this;return!this.settings.host.ad_refresh_active||e.reached_refresh_limit()?null:setTimeout(function(){e.is_serving_ads()&&(e.ad_refresh_count+=1),e.is_any_ad_unit_in_viewport()?e.refresh_ads():e.ad_refresh_timer=e.ad_refresh_set_timer()},1e3*this.settings.host.ad_refresh_seconds)}},{key:"handle_ad_refresh",value:function(){var e=this;this.ad_refresh_timer=this.ad_refresh_set_timer();var t=void 0;void 0!==document.hidden?t="hidden":void 0!==document.msHidden?t="msHidden":void 0!==document.webkitHidden&&(t="webkitHidden"),document.addEventListener("visibilitychange",function(){document[t]?clearTimeout(e.ad_refresh_timer):e.ad_refresh_timer=e.ad_refresh_set_timer()})}},{key:"generate_redirect_hash",value:function(e,t,n){var i={url:t,is_mobile:this.settings.is_mobile};for(var o in e)e.hasOwnProperty(o)&&(i[o]=e[o]);var a=new Date((new Date).toUTCString()).getTime(),c={uuid:this.device.uuid,session_id:this.session.id,funnel_id:e.funnel_id,name:n,recipe_id:this.settings.recipe.id,viewport_height:(0,r.default)(window.document).height(),viewport_width:(0,r.default)(window.document).width(),language:window.navigator.language||navigator.userLanguage,encoding:window.document.characterSet||window.document.defaultCharset,url:window.document.location.href,referrer:window.document.referrer,duration:a-(window.performance?window.performance.timing.domContentLoadedEventEnd:LOAD_TIME),client_timestamp:a,properties:r.default.extend({},this.device.properties,this.session.properties,this.funnel.properties,i||{})};delete c.properties.funnel_id;var u=JSON.stringify(c);return s.Base64.encodeURI(u)}}]),e}();t.default=new c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){n.d(t,"version",function(){return i}),n.d(t,"VERSION",function(){return r}),n.d(t,"atob",function(){return T}),n.d(t,"atobPolyfill",function(){return P}),n.d(t,"btoa",function(){return _}),n.d(t,"btoaPolyfill",function(){return m}),n.d(t,"fromBase64",function(){return U}),n.d(t,"toBase64",function(){return O}),n.d(t,"utob",function(){return A}),n.d(t,"encode",function(){return O}),n.d(t,"encodeURI",function(){return C}),n.d(t,"encodeURL",function(){return C}),n.d(t,"btou",function(){return S}),n.d(t,"decode",function(){return U}),n.d(t,"isValid",function(){return I}),n.d(t,"fromUint8Array",function(){return w}),n.d(t,"toUint8Array",function(){return B}),n.d(t,"extendString",function(){return $}),n.d(t,"extendUint8Array",function(){return D}),n.d(t,"extendBuiltins",function(){return Y}),n.d(t,"Base64",function(){return q});const i="3.6.0",r=i,o="function"==typeof atob,s="function"==typeof btoa,a="function"==typeof e,c="function"==typeof TextDecoder?new TextDecoder:void 0,u="function"==typeof TextEncoder?new TextEncoder:void 0,l=[..."ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="],f=(e=>{let t={};return l.forEach((e,n)=>t[e]=n),t})(),h=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,d=String.fromCharCode.bind(String),p="function"==typeof Uint8Array.from?Uint8Array.from.bind(Uint8Array):(e,t=(e=>e))=>new Uint8Array(Array.prototype.slice.call(e,0).map(t)),g=e=>e.replace(/[+\/]/g,e=>"+"==e?"-":"_").replace(/=+$/m,""),v=e=>e.replace(/[^A-Za-z0-9\+\/]/g,""),m=e=>{let t,n,i,r,o="";const s=e.length%3;for(let s=0;s<e.length;){if((n=e.charCodeAt(s++))>255||(i=e.charCodeAt(s++))>255||(r=e.charCodeAt(s++))>255)throw new TypeError("invalid character found");o+=l[(t=n<<16|i<<8|r)>>18&63]+l[t>>12&63]+l[t>>6&63]+l[63&t]}return s?o.slice(0,s-3)+"===".substring(s):o},_=s?e=>btoa(e):a?t=>e.from(t,"binary").toString("base64"):m,y=a?t=>e.from(t).toString("base64"):e=>{let t=[];for(let n=0,i=e.length;n<i;n+=4096)t.push(d.apply(null,e.subarray(n,n+4096)));return _(t.join(""))},w=(e,t=!1)=>t?g(y(e)):y(e),b=e=>{if(e.length<2)return(t=e.charCodeAt(0))<128?e:t<2048?d(192|t>>>6)+d(128|63&t):d(224|t>>>12&15)+d(128|t>>>6&63)+d(128|63&t);var t=65536+1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320);return d(240|t>>>18&7)+d(128|t>>>12&63)+d(128|t>>>6&63)+d(128|63&t)},E=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,A=e=>e.replace(E,b),k=a?t=>e.from(t,"utf8").toString("base64"):u?e=>y(u.encode(e)):e=>_(A(e)),O=(e,t=!1)=>t?g(k(e)):k(e),C=e=>O(e,!0),x=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,R=e=>{switch(e.length){case 4:var t=((7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3))-65536;return d(55296+(t>>>10))+d(56320+(1023&t));case 3:return d((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return d((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},S=e=>e.replace(x,R),P=e=>{if(e=e.replace(/\s+/g,""),!h.test(e))throw new TypeError("malformed base64.");e+="==".slice(2-(3&e.length));let t,n,i,r="";for(let o=0;o<e.length;)t=f[e.charAt(o++)]<<18|f[e.charAt(o++)]<<12|(n=f[e.charAt(o++)])<<6|(i=f[e.charAt(o++)]),r+=64===n?d(t>>16&255):64===i?d(t>>16&255,t>>8&255):d(t>>16&255,t>>8&255,255&t);return r},T=o?e=>atob(v(e)):a?t=>e.from(t,"base64").toString("binary"):P,j=a?t=>p(e.from(t,"base64")):e=>p(T(e),e=>e.charCodeAt(0)),B=e=>j(L(e)),N=a?t=>e.from(t,"base64").toString("utf8"):c?e=>c.decode(j(e)):e=>S(T(e)),L=e=>v(e.replace(/[-_]/g,e=>"-"==e?"+":"/")),U=e=>N(L(e)),I=e=>{if("string"!=typeof e)return!1;const t=e.replace(/\s+/g,"").replace(/=+$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(t)||!/[^\s0-9a-zA-Z\-_]/.test(t)},M=e=>({value:e,enumerable:!1,writable:!0,configurable:!0}),$=function(){const e=(e,t)=>Object.defineProperty(String.prototype,e,M(t));e("fromBase64",function(){return U(this)}),e("toBase64",function(e){return O(this,e)}),e("toBase64URI",function(){return O(this,!0)}),e("toBase64URL",function(){return O(this,!0)}),e("toUint8Array",function(){return B(this)})},D=function(){const e=(e,t)=>Object.defineProperty(Uint8Array.prototype,e,M(t));e("toBase64",function(e){return w(this,e)}),e("toBase64URI",function(){return w(this,!0)}),e("toBase64URL",function(){return w(this,!0)})},Y=()=>{$(),D()},q={version:i,VERSION:r,atob:T,atobPolyfill:P,btoa:_,btoaPolyfill:m,fromBase64:U,toBase64:O,encode:O,encodeURI:C,encodeURL:C,utob:A,btou:S,decode:U,isValid:I,fromUint8Array:w,toUint8Array:B,extendString:$,extendUint8Array:D,extendBuiltins:Y}}.call(t,n(22).Buffer)},function(e,t,n){"use strict";(function(e){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */
var i=n(23),r=n(24),o=n(25);function s(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(e,t){if(s()<t)throw new RangeError("Invalid typed array length");return c.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=c.prototype:(null===e&&(e=new c(t)),e.length=t),e}function c(e,t,n){if(!(c.TYPED_ARRAY_SUPPORT||this instanceof c))return new c(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return f(this,e)}return u(this,e,t,n)}function u(e,t,n,i){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,i){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(i||0))throw new RangeError("'length' is out of bounds");t=void 0===n&&void 0===i?new Uint8Array(t):void 0===i?new Uint8Array(t,n):new Uint8Array(t,n,i);c.TYPED_ARRAY_SUPPORT?(e=t).__proto__=c.prototype:e=h(e,t);return e}(e,t,n,i):"string"==typeof t?function(e,t,n){"string"==typeof n&&""!==n||(n="utf8");if(!c.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var i=0|p(t,n),r=(e=a(e,i)).write(t,n);r!==i&&(e=e.slice(0,r));return e}(e,t,n):function(e,t){if(c.isBuffer(t)){var n=0|d(t.length);return 0===(e=a(e,n)).length?e:(t.copy(e,0,0,n),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||function(e){return e!=e}(t.length)?a(e,0):h(e,t);if("Buffer"===t.type&&o(t.data))return h(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function f(e,t){if(l(t),e=a(e,t<0?0:0|d(t)),!c.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function h(e,t){var n=t.length<0?0:0|d(t.length);e=a(e,n);for(var i=0;i<n;i+=1)e[i]=255&t[i];return e}function d(e){if(e>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|e}function p(e,t){if(c.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return D(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return Y(e).length;default:if(i)return D(e).length;t=(""+t).toLowerCase(),i=!0}}function g(e,t,n){var i=e[t];e[t]=e[n],e[n]=i}function v(e,t,n,i,r){if(0===e.length)return-1;if("string"==typeof n?(i=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=r?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(r)return-1;n=e.length-1}else if(n<0){if(!r)return-1;n=0}if("string"==typeof t&&(t=c.from(t,i)),c.isBuffer(t))return 0===t.length?-1:m(e,t,n,i,r);if("number"==typeof t)return t&=255,c.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?r?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):m(e,[t],n,i,r);throw new TypeError("val must be string, number or Buffer")}function m(e,t,n,i,r){var o,s=1,a=e.length,c=t.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(e.length<2||t.length<2)return-1;s=2,a/=2,c/=2,n/=2}function u(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(r){var l=-1;for(o=n;o<a;o++)if(u(e,o)===u(t,-1===l?0:o-l)){if(-1===l&&(l=o),o-l+1===c)return l*s}else-1!==l&&(o-=o-l),l=-1}else for(n+c>a&&(n=a-c),o=n;o>=0;o--){for(var f=!0,h=0;h<c;h++)if(u(e,o+h)!==u(t,h)){f=!1;break}if(f)return o}return-1}function _(e,t,n,i){n=Number(n)||0;var r=e.length-n;i?(i=Number(i))>r&&(i=r):i=r;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");i>o/2&&(i=o/2);for(var s=0;s<i;++s){var a=parseInt(t.substr(2*s,2),16);if(isNaN(a))return s;e[n+s]=a}return s}function y(e,t,n,i){return q(D(t,e.length-n),e,n,i)}function w(e,t,n,i){return q(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,i)}function b(e,t,n,i){return w(e,t,n,i)}function E(e,t,n,i){return q(Y(t),e,n,i)}function A(e,t,n,i){return q(function(e,t){for(var n,i,r,o=[],s=0;s<e.length&&!((t-=2)<0);++s)n=e.charCodeAt(s),i=n>>8,r=n%256,o.push(r),o.push(i);return o}(t,e.length-n),e,n,i)}function k(e,t,n){return 0===t&&n===e.length?i.fromByteArray(e):i.fromByteArray(e.slice(t,n))}function O(e,t,n){n=Math.min(e.length,n);for(var i=[],r=t;r<n;){var o,s,a,c,u=e[r],l=null,f=u>239?4:u>223?3:u>191?2:1;if(r+f<=n)switch(f){case 1:u<128&&(l=u);break;case 2:128==(192&(o=e[r+1]))&&(c=(31&u)<<6|63&o)>127&&(l=c);break;case 3:o=e[r+1],s=e[r+2],128==(192&o)&&128==(192&s)&&(c=(15&u)<<12|(63&o)<<6|63&s)>2047&&(c<55296||c>57343)&&(l=c);break;case 4:o=e[r+1],s=e[r+2],a=e[r+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&(c=(15&u)<<18|(63&o)<<12|(63&s)<<6|63&a)>65535&&c<1114112&&(l=c)}null===l?(l=65533,f=1):l>65535&&(l-=65536,i.push(l>>>10&1023|55296),l=56320|1023&l),i.push(l),r+=f}return function(e){var t=e.length;if(t<=C)return String.fromCharCode.apply(String,e);var n="",i=0;for(;i<t;)n+=String.fromCharCode.apply(String,e.slice(i,i+=C));return n}(i)}t.Buffer=c,t.SlowBuffer=function(e){+e!=e&&(e=0);return c.alloc(+e)},t.INSPECT_MAX_BYTES=50,c.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=s(),c.poolSize=8192,c._augment=function(e){return e.__proto__=c.prototype,e},c.from=function(e,t,n){return u(null,e,t,n)},c.TYPED_ARRAY_SUPPORT&&(c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0})),c.alloc=function(e,t,n){return function(e,t,n,i){return l(t),t<=0?a(e,t):void 0!==n?"string"==typeof i?a(e,t).fill(n,i):a(e,t).fill(n):a(e,t)}(null,e,t,n)},c.allocUnsafe=function(e){return f(null,e)},c.allocUnsafeSlow=function(e){return f(null,e)},c.isBuffer=function(e){return!(null==e||!e._isBuffer)},c.compare=function(e,t){if(!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,i=t.length,r=0,o=Math.min(n,i);r<o;++r)if(e[r]!==t[r]){n=e[r],i=t[r];break}return n<i?-1:i<n?1:0},c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(e,t){if(!o(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return c.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var i=c.allocUnsafe(t),r=0;for(n=0;n<e.length;++n){var s=e[n];if(!c.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(i,r),r+=s.length}return i},c.byteLength=p,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)g(this,t,t+1);return this},c.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)g(this,t,t+3),g(this,t+1,t+2);return this},c.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)g(this,t,t+7),g(this,t+1,t+6),g(this,t+2,t+5),g(this,t+3,t+4);return this},c.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?O(this,0,e):function(e,t,n){var i=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return S(this,t,n);case"utf8":case"utf-8":return O(this,t,n);case"ascii":return x(this,t,n);case"latin1":case"binary":return R(this,t,n);case"base64":return k(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,t,n);default:if(i)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),i=!0}}.apply(this,arguments)},c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===c.compare(this,e)},c.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},c.prototype.compare=function(e,t,n,i,r){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===i&&(i=0),void 0===r&&(r=this.length),t<0||n>e.length||i<0||r>this.length)throw new RangeError("out of range index");if(i>=r&&t>=n)return 0;if(i>=r)return-1;if(t>=n)return 1;if(t>>>=0,n>>>=0,i>>>=0,r>>>=0,this===e)return 0;for(var o=r-i,s=n-t,a=Math.min(o,s),u=this.slice(i,r),l=e.slice(t,n),f=0;f<a;++f)if(u[f]!==l[f]){o=u[f],s=l[f];break}return o<s?-1:s<o?1:0},c.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},c.prototype.indexOf=function(e,t,n){return v(this,e,t,n,!0)},c.prototype.lastIndexOf=function(e,t,n){return v(this,e,t,n,!1)},c.prototype.write=function(e,t,n,i){if(void 0===t)i="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)i=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===i&&(i="utf8")):(i=n,n=void 0)}var r=this.length-t;if((void 0===n||n>r)&&(n=r),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var o=!1;;)switch(i){case"hex":return _(this,e,t,n);case"utf8":case"utf-8":return y(this,e,t,n);case"ascii":return w(this,e,t,n);case"latin1":case"binary":return b(this,e,t,n);case"base64":return E(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),o=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var C=4096;function x(e,t,n){var i="";n=Math.min(e.length,n);for(var r=t;r<n;++r)i+=String.fromCharCode(127&e[r]);return i}function R(e,t,n){var i="";n=Math.min(e.length,n);for(var r=t;r<n;++r)i+=String.fromCharCode(e[r]);return i}function S(e,t,n){var i=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>i)&&(n=i);for(var r="",o=t;o<n;++o)r+=$(e[o]);return r}function P(e,t,n){for(var i=e.slice(t,n),r="",o=0;o<i.length;o+=2)r+=String.fromCharCode(i[o]+256*i[o+1]);return r}function T(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function j(e,t,n,i,r,o){if(!c.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>r||t<o)throw new RangeError('"value" argument is out of bounds');if(n+i>e.length)throw new RangeError("Index out of range")}function B(e,t,n,i){t<0&&(t=65535+t+1);for(var r=0,o=Math.min(e.length-n,2);r<o;++r)e[n+r]=(t&255<<8*(i?r:1-r))>>>8*(i?r:1-r)}function N(e,t,n,i){t<0&&(t=4294967295+t+1);for(var r=0,o=Math.min(e.length-n,4);r<o;++r)e[n+r]=t>>>8*(i?r:3-r)&255}function L(e,t,n,i,r,o){if(n+i>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function U(e,t,n,i,o){return o||L(e,0,n,4),r.write(e,t,n,i,23,4),n+4}function I(e,t,n,i,o){return o||L(e,0,n,8),r.write(e,t,n,i,52,8),n+8}c.prototype.slice=function(e,t){var n,i=this.length;if(e=~~e,t=void 0===t?i:~~t,e<0?(e+=i)<0&&(e=0):e>i&&(e=i),t<0?(t+=i)<0&&(t=0):t>i&&(t=i),t<e&&(t=e),c.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=c.prototype;else{var r=t-e;n=new c(r,void 0);for(var o=0;o<r;++o)n[o]=this[o+e]}return n},c.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||T(e,t,this.length);for(var i=this[e],r=1,o=0;++o<t&&(r*=256);)i+=this[e+o]*r;return i},c.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||T(e,t,this.length);for(var i=this[e+--t],r=1;t>0&&(r*=256);)i+=this[e+--t]*r;return i},c.prototype.readUInt8=function(e,t){return t||T(e,1,this.length),this[e]},c.prototype.readUInt16LE=function(e,t){return t||T(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUInt16BE=function(e,t){return t||T(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUInt32LE=function(e,t){return t||T(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUInt32BE=function(e,t){return t||T(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||T(e,t,this.length);for(var i=this[e],r=1,o=0;++o<t&&(r*=256);)i+=this[e+o]*r;return i>=(r*=128)&&(i-=Math.pow(2,8*t)),i},c.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||T(e,t,this.length);for(var i=t,r=1,o=this[e+--i];i>0&&(r*=256);)o+=this[e+--i]*r;return o>=(r*=128)&&(o-=Math.pow(2,8*t)),o},c.prototype.readInt8=function(e,t){return t||T(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},c.prototype.readInt16LE=function(e,t){t||T(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt16BE=function(e,t){t||T(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt32LE=function(e,t){return t||T(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return t||T(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readFloatLE=function(e,t){return t||T(e,4,this.length),r.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return t||T(e,4,this.length),r.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return t||T(e,8,this.length),r.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return t||T(e,8,this.length),r.read(this,e,!1,52,8)},c.prototype.writeUIntLE=function(e,t,n,i){(e=+e,t|=0,n|=0,i)||j(this,e,t,n,Math.pow(2,8*n)-1,0);var r=1,o=0;for(this[t]=255&e;++o<n&&(r*=256);)this[t+o]=e/r&255;return t+n},c.prototype.writeUIntBE=function(e,t,n,i){(e=+e,t|=0,n|=0,i)||j(this,e,t,n,Math.pow(2,8*n)-1,0);var r=n-1,o=1;for(this[t+r]=255&e;--r>=0&&(o*=256);)this[t+r]=e/o&255;return t+n},c.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||j(this,e,t,1,255,0),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},c.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||j(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):B(this,e,t,!0),t+2},c.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||j(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):B(this,e,t,!1),t+2},c.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||j(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):N(this,e,t,!0),t+4},c.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||j(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):N(this,e,t,!1),t+4},c.prototype.writeIntLE=function(e,t,n,i){if(e=+e,t|=0,!i){var r=Math.pow(2,8*n-1);j(this,e,t,n,r-1,-r)}var o=0,s=1,a=0;for(this[t]=255&e;++o<n&&(s*=256);)e<0&&0===a&&0!==this[t+o-1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+n},c.prototype.writeIntBE=function(e,t,n,i){if(e=+e,t|=0,!i){var r=Math.pow(2,8*n-1);j(this,e,t,n,r-1,-r)}var o=n-1,s=1,a=0;for(this[t+o]=255&e;--o>=0&&(s*=256);)e<0&&0===a&&0!==this[t+o+1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+n},c.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||j(this,e,t,1,127,-128),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},c.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||j(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):B(this,e,t,!0),t+2},c.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||j(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):B(this,e,t,!1),t+2},c.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||j(this,e,t,4,2147483647,-2147483648),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):N(this,e,t,!0),t+4},c.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||j(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):N(this,e,t,!1),t+4},c.prototype.writeFloatLE=function(e,t,n){return U(this,e,t,!0,n)},c.prototype.writeFloatBE=function(e,t,n){return U(this,e,t,!1,n)},c.prototype.writeDoubleLE=function(e,t,n){return I(this,e,t,!0,n)},c.prototype.writeDoubleBE=function(e,t,n){return I(this,e,t,!1,n)},c.prototype.copy=function(e,t,n,i){if(n||(n=0),i||0===i||(i=this.length),t>=e.length&&(t=e.length),t||(t=0),i>0&&i<n&&(i=n),i===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-n&&(i=e.length-t+n);var r,o=i-n;if(this===e&&n<t&&t<i)for(r=o-1;r>=0;--r)e[r+t]=this[r+n];else if(o<1e3||!c.TYPED_ARRAY_SUPPORT)for(r=0;r<o;++r)e[r+t]=this[r+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+o),t);return o},c.prototype.fill=function(e,t,n,i){if("string"==typeof e){if("string"==typeof t?(i=t,t=0,n=this.length):"string"==typeof n&&(i=n,n=this.length),1===e.length){var r=e.charCodeAt(0);r<256&&(e=r)}if(void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!c.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var o;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(o=t;o<n;++o)this[o]=e;else{var s=c.isBuffer(e)?e:D(new c(e,i).toString()),a=s.length;for(o=0;o<n-t;++o)this[o+t]=s[o%a]}return this};var M=/[^+\/0-9A-Za-z-_]/g;function $(e){return e<16?"0"+e.toString(16):e.toString(16)}function D(e,t){var n;t=t||1/0;for(var i=e.length,r=null,o=[],s=0;s<i;++s){if((n=e.charCodeAt(s))>55295&&n<57344){if(!r){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(s+1===i){(t-=3)>-1&&o.push(239,191,189);continue}r=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),r=n;continue}n=65536+(r-55296<<10|n-56320)}else r&&(t-=3)>-1&&o.push(239,191,189);if(r=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function Y(e){return i.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(M,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function q(e,t,n,i){for(var r=0;r<i&&!(r+n>=t.length||r>=e.length);++r)t[r+n]=e[r];return r}}).call(t,n(2))},function(e,t,n){"use strict";t.byteLength=function(e){var t=u(e),n=t[0],i=t[1];return 3*(n+i)/4-i},t.toByteArray=function(e){var t,n,i=u(e),s=i[0],a=i[1],c=new o(function(e,t,n){return 3*(t+n)/4-n}(0,s,a)),l=0,f=a>0?s-4:s;for(n=0;n<f;n+=4)t=r[e.charCodeAt(n)]<<18|r[e.charCodeAt(n+1)]<<12|r[e.charCodeAt(n+2)]<<6|r[e.charCodeAt(n+3)],c[l++]=t>>16&255,c[l++]=t>>8&255,c[l++]=255&t;2===a&&(t=r[e.charCodeAt(n)]<<2|r[e.charCodeAt(n+1)]>>4,c[l++]=255&t);1===a&&(t=r[e.charCodeAt(n)]<<10|r[e.charCodeAt(n+1)]<<4|r[e.charCodeAt(n+2)]>>2,c[l++]=t>>8&255,c[l++]=255&t);return c},t.fromByteArray=function(e){for(var t,n=e.length,r=n%3,o=[],s=0,a=n-r;s<a;s+=16383)o.push(f(e,s,s+16383>a?a:s+16383));1===r?(t=e[n-1],o.push(i[t>>2]+i[t<<4&63]+"==")):2===r&&(t=(e[n-2]<<8)+e[n-1],o.push(i[t>>10]+i[t>>4&63]+i[t<<2&63]+"="));return o.join("")};for(var i=[],r=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,c=s.length;a<c;++a)i[a]=s[a],r[s.charCodeAt(a)]=a;function u(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function l(e){return i[e>>18&63]+i[e>>12&63]+i[e>>6&63]+i[63&e]}function f(e,t,n){for(var i,r=[],o=t;o<n;o+=3)i=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),r.push(l(i));return r.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},function(e,t){
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
t.read=function(e,t,n,i,r){var o,s,a=8*r-i-1,c=(1<<a)-1,u=c>>1,l=-7,f=n?r-1:0,h=n?-1:1,d=e[t+f];for(f+=h,o=d&(1<<-l)-1,d>>=-l,l+=a;l>0;o=256*o+e[t+f],f+=h,l-=8);for(s=o&(1<<-l)-1,o>>=-l,l+=i;l>0;s=256*s+e[t+f],f+=h,l-=8);if(0===o)o=1-u;else{if(o===c)return s?NaN:1/0*(d?-1:1);s+=Math.pow(2,i),o-=u}return(d?-1:1)*s*Math.pow(2,o-i)},t.write=function(e,t,n,i,r,o){var s,a,c,u=8*o-r-1,l=(1<<u)-1,f=l>>1,h=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,d=i?0:o-1,p=i?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=l):(s=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-s))<1&&(s--,c*=2),(t+=s+f>=1?h/c:h*Math.pow(2,1-f))*c>=2&&(s++,c/=2),s+f>=l?(a=0,s=l):s+f>=1?(a=(t*c-1)*Math.pow(2,r),s+=f):(a=t*Math.pow(2,f-1)*Math.pow(2,r),s=0));r>=8;e[n+d]=255&a,d+=p,a/=256,r-=8);for(s=s<<r|a,u+=r;u>0;e[n+d]=255&s,d+=p,s/=256,u-=8);e[n+d-p]|=128*g}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=function(e){return e&&e.__esModule?e:{default:e}}(n(0));var o=window.location.protocol+"//chicoryapp.com",s={crosspixel:{name:"crosspixel",url:"//tag.crsspxl.com/s1.js?d=[PIXEL_CODE]&cb=[DATE]",type:"script"},ignitionone:{name:"ignitionone",url:"//chico.netmng.com/?aid=4640&siclientid=&tax=[PIXEL_CODE]&cch",type:"script"},mediamath:{name:"mediamath",url:"//pixel.mathtag.com/data/img?mt_id=[PIXEL_CODE]&v1=&v2=&v3=&s1=&s2=&s3=",type:"image"},quantcast:{name:"quantcast",url:"https://secure.quantserve.com/quant.js",type:"script",callback:function(e,t,n){"load_recipe"===e&&(window._qevents=window._qevents||[],window._qevents.push({qacct:n.pixel,labels:"Publisher."+t.host.name.replace(/,/g,"|").replace(/\./g,"_")}))}},dbm:{name:"dbm",url:"//3792445.fls.doubleclick.net/activityi;src=3792445;type=chico0;cat=[PIXEL_CODE];dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=[DATE]?",type:"iframe"}},a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.settings={}}return i(e,[{key:"deactivate",value:function(){this.settings={}}},{key:"activate",value:function(e){e.chicory_opt_out?console.log("Chicory IBA opt-out cookie present"):e.recipes||this.load(e).then(this.run.bind(this)).catch(r.default.done)}},{key:"load",value:function(e){var t=this;return new Promise(function(n){var i={recipe:e.recipe.id};r.default.get(o+"/api/segments",i).then(function(i){return r.default.extend(t.settings,e,i),n()}).catch(r.default.done)}.bind(this))}},{key:"run",value:function(){r.default.each(this.settings.segments,function(e,t){this.injectPixel(t)}.bind(this)),r.default.each(this.settings.cookies,function(e,t){this.injectCookie(t)}.bind(this))}},{key:"injectPixel",value:function(e){if(e.dsp in s){var t=s[e.dsp],n=r.default[t.type],i=(new Date).getTime();r.default.each(e.trigger_events,function(o,s){r.default.listen(s,function(o){var a=t.url.replace("[DATE]",i).replace("[PIXEL_CODE]",e.pixel),c=n(a);t.callback&&c.then(t.callback.bind(this,s,o,e)).catch(r.default.done),r.default.send("load_segment",{}),console.log("Chicory: injecting audience segment pixel")})})}}},{key:"injectCookie",value:function(e){r.default.send("load_cookie",e),console.log("Chicory: injecting cookie sync pixel")}}]),e}();t.default=new a}]);
//# sourceMappingURL=wrapper.full.c49368183045dd974c3b.min.js.map